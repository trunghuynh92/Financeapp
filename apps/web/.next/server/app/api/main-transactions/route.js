"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/main-transactions/route";
exports.ids = ["app/api/main-transactions/route"];
exports.modules = {

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/../../node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fmain-transactions%2Froute&page=%2Fapi%2Fmain-transactions%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmain-transactions%2Froute.ts&appDir=%2FUsers%2Ftrunghuynh%2FDeveloper%2FFinanceapp%2Fapps%2Fweb%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Ftrunghuynh%2FDeveloper%2FFinanceapp%2Fapps%2Fweb&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ../../node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fmain-transactions%2Froute&page=%2Fapi%2Fmain-transactions%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmain-transactions%2Froute.ts&appDir=%2FUsers%2Ftrunghuynh%2FDeveloper%2FFinanceapp%2Fapps%2Fweb%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Ftrunghuynh%2FDeveloper%2FFinanceapp%2Fapps%2Fweb&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/../../node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/../../node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/../../node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_trunghuynh_Developer_Financeapp_apps_web_app_api_main_transactions_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/main-transactions/route.ts */ \"(rsc)/./app/api/main-transactions/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/main-transactions/route\",\n        pathname: \"/api/main-transactions\",\n        filename: \"route\",\n        bundlePath: \"app/api/main-transactions/route\"\n    },\n    resolvedPagePath: \"/Users/trunghuynh/Developer/Financeapp/apps/web/app/api/main-transactions/route.ts\",\n    nextConfigOutput,\n    userland: _Users_trunghuynh_Developer_Financeapp_apps_web_app_api_main_transactions_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/main-transactions/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi4vLi4vbm9kZV9tb2R1bGVzL25leHQvZGlzdC9idWlsZC93ZWJwYWNrL2xvYWRlcnMvbmV4dC1hcHAtbG9hZGVyLmpzP25hbWU9YXBwJTJGYXBpJTJGbWFpbi10cmFuc2FjdGlvbnMlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRm1haW4tdHJhbnNhY3Rpb25zJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGbWFpbi10cmFuc2FjdGlvbnMlMkZyb3V0ZS50cyZhcHBEaXI9JTJGVXNlcnMlMkZ0cnVuZ2h1eW5oJTJGRGV2ZWxvcGVyJTJGRmluYW5jZWFwcCUyRmFwcHMlMkZ3ZWIlMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRlVzZXJzJTJGdHJ1bmdodXluaCUyRkRldmVsb3BlciUyRkZpbmFuY2VhcHAlMkZhcHBzJTJGd2ViJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUNrQztBQUMvRztBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL0BmaW5hbmNlYXBwL3dlYi8/YzFhMSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIvVXNlcnMvdHJ1bmdodXluaC9EZXZlbG9wZXIvRmluYW5jZWFwcC9hcHBzL3dlYi9hcHAvYXBpL21haW4tdHJhbnNhY3Rpb25zL3JvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9tYWluLXRyYW5zYWN0aW9ucy9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL21haW4tdHJhbnNhY3Rpb25zXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9tYWluLXRyYW5zYWN0aW9ucy9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIi9Vc2Vycy90cnVuZ2h1eW5oL0RldmVsb3Blci9GaW5hbmNlYXBwL2FwcHMvd2ViL2FwcC9hcGkvbWFpbi10cmFuc2FjdGlvbnMvcm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL21haW4tdHJhbnNhY3Rpb25zL3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIG9yaWdpbmFsUGF0aG5hbWUsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/../../node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fmain-transactions%2Froute&page=%2Fapi%2Fmain-transactions%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmain-transactions%2Froute.ts&appDir=%2FUsers%2Ftrunghuynh%2FDeveloper%2FFinanceapp%2Fapps%2Fweb%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Ftrunghuynh%2FDeveloper%2FFinanceapp%2Fapps%2Fweb&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/main-transactions/route.ts":
/*!********************************************!*\
  !*** ./app/api/main-transactions/route.ts ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/../../node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_supabase_server__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/supabase-server */ \"(rsc)/./lib/supabase-server.ts\");\n/**\n * API Route: /api/main-transactions\n * Purpose: List and manage main_transaction records with full categorization\n */ \n\n// ==============================================================================\n// POST - Create a new main transaction\n// ==============================================================================\nasync function POST(request) {\n    try {\n        const supabase = (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_1__.createSupabaseServerClient)();\n        const body = await request.json();\n        // Validate required fields\n        const { raw_transaction_id, account_id, transaction_type_id, amount, transaction_direction, transaction_date, description, category_id, branch_id, notes } = body;\n        if (!raw_transaction_id || !account_id || !transaction_type_id || amount === undefined || !transaction_direction || !transaction_date) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Missing required fields: raw_transaction_id, account_id, transaction_type_id, amount, transaction_direction, transaction_date\"\n            }, {\n                status: 400\n            });\n        }\n        // Create the transaction\n        const { data, error } = await supabase.from(\"main_transaction\").insert({\n            raw_transaction_id,\n            account_id,\n            transaction_type_id,\n            amount,\n            transaction_direction,\n            transaction_date,\n            description: description || null,\n            category_id: category_id || null,\n            branch_id: branch_id || null,\n            notes: notes || null\n        }).select().single();\n        if (error) {\n            console.error(\"Error creating transaction:\", error);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: error.message\n            }, {\n                status: 500\n            });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            data\n        }, {\n            status: 201\n        });\n    } catch (error) {\n        console.error(\"Unexpected error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"An unexpected error occurred\"\n        }, {\n            status: 500\n        });\n    }\n}\n// ==============================================================================\n// GET - List main transactions with filters and pagination\n// ==============================================================================\nasync function GET(request) {\n    try {\n        const supabase = (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_1__.createSupabaseServerClient)();\n        const searchParams = request.nextUrl.searchParams;\n        // Filters\n        const entityId = searchParams.get(\"entity_id\");\n        const accountId = searchParams.get(\"account_id\");\n        const transactionTypeId = searchParams.get(\"transaction_type_id\");\n        const categoryId = searchParams.get(\"category_id\");\n        const branchId = searchParams.get(\"branch_id\");\n        const projectId = searchParams.get(\"project_id\");\n        const transactionDirection = searchParams.get(\"transaction_direction\");\n        const startDate = searchParams.get(\"start_date\");\n        const endDate = searchParams.get(\"end_date\");\n        const search = searchParams.get(\"search\");\n        const isSplit = searchParams.get(\"is_split\");\n        const isUnmatchedTransfer = searchParams.get(\"is_unmatched_transfer\");\n        const rawTransactionId = searchParams.get(\"raw_transaction_id\");\n        const drawdownId = searchParams.get(\"drawdown_id\");\n        const loanDisbursementId = searchParams.get(\"loan_disbursement_id\");\n        const amountOperator = searchParams.get(\"amount_operator\");\n        const amountValue = searchParams.get(\"amount_value\");\n        const accountTypes = searchParams.get(\"account_types\") // e.g., \"bank,cash\"\n        ;\n        // Pagination\n        const page = parseInt(searchParams.get(\"page\") || \"1\");\n        const limit = parseInt(searchParams.get(\"limit\") || \"50\");\n        // Sorting\n        const sortField = searchParams.get(\"sort_field\") || \"transaction_date\";\n        const sortDirection = searchParams.get(\"sort_direction\") || \"desc\";\n        // If entity_id filter is provided, get all account IDs for that entity first\n        let accountIdsForEntity = [];\n        if (entityId && !accountId) {\n            const { data: entityAccounts } = await supabase.from(\"accounts\").select(\"account_id\").eq(\"entity_id\", entityId);\n            accountIdsForEntity = entityAccounts?.map((a)=>a.account_id) || [];\n            // If entity has no accounts, return empty result\n            if (accountIdsForEntity.length === 0) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    data: [],\n                    pagination: {\n                        page,\n                        limit,\n                        total: 0,\n                        totalPages: 0\n                    }\n                });\n            }\n        }\n        // Use the view for full details\n        let query = supabase.from(\"main_transaction_details\").select(\"*\");\n        // IMPORTANT: Exclude balance adjustment transactions (system-generated)\n        // Balance adjustments should only be viewed/edited through checkpoints\n        query = query.or(\"is_balance_adjustment.is.null,is_balance_adjustment.eq.false\");\n        // Apply filters\n        if (accountId) {\n            // Specific account filter takes priority\n            query = query.eq(\"account_id\", accountId);\n        } else if (entityId && accountIdsForEntity.length > 0) {\n            // Filter by entity's accounts\n            query = query.in(\"account_id\", accountIdsForEntity);\n        }\n        if (transactionTypeId) {\n            query = query.eq(\"transaction_type_id\", transactionTypeId);\n        }\n        if (categoryId) {\n            if (categoryId === \"none\") {\n                // Filter for uncategorized transactions (category_id is NULL)\n                query = query.is(\"category_id\", null);\n            } else {\n                query = query.eq(\"category_id\", categoryId);\n            }\n        }\n        if (branchId) {\n            query = query.eq(\"branch_id\", branchId);\n        }\n        if (projectId) {\n            if (projectId === \"none\") {\n                // Filter for transactions without a project (project_id is NULL)\n                query = query.is(\"project_id\", null);\n            } else {\n                query = query.eq(\"project_id\", projectId);\n            }\n        }\n        if (drawdownId) {\n            query = query.eq(\"drawdown_id\", drawdownId);\n        }\n        if (loanDisbursementId) {\n            query = query.eq(\"loan_disbursement_id\", loanDisbursementId);\n        }\n        if (transactionDirection) {\n            query = query.eq(\"transaction_direction\", transactionDirection);\n        }\n        if (startDate) {\n            query = query.gte(\"transaction_date\", startDate);\n        }\n        if (endDate) {\n            query = query.lte(\"transaction_date\", endDate);\n        }\n        if (search) {\n            query = query.or(`description.ilike.%${search}%,notes.ilike.%${search}%`);\n        }\n        if (isSplit !== null) {\n            query = query.eq(\"is_split\", isSplit === \"true\");\n        }\n        if (isUnmatchedTransfer === \"true\") {\n            // Only show transfers without matches\n            query = query.in(\"transaction_type_code\", [\n                \"TRF_OUT\",\n                \"TRF_IN\"\n            ]).is(\"transfer_matched_transaction_id\", null);\n        }\n        if (rawTransactionId) {\n            query = query.eq(\"raw_transaction_id\", rawTransactionId);\n        }\n        // Account type filter (e.g., only show bank and cash accounts)\n        if (accountTypes) {\n            const typesArray = accountTypes.split(\",\").map((t)=>t.trim());\n            query = query.in(\"account_type\", typesArray);\n        }\n        // Amount filter\n        if (amountOperator && amountOperator !== \"all\" && amountValue) {\n            const amount = parseFloat(amountValue);\n            if (!isNaN(amount)) {\n                switch(amountOperator){\n                    case \"eq\":\n                        query = query.eq(\"amount\", amount);\n                        break;\n                    case \"gt\":\n                        query = query.gt(\"amount\", amount);\n                        break;\n                    case \"lt\":\n                        query = query.lt(\"amount\", amount);\n                        break;\n                    case \"gte\":\n                        query = query.gte(\"amount\", amount);\n                        break;\n                    case \"lte\":\n                        query = query.lte(\"amount\", amount);\n                        break;\n                    case \"neq\":\n                        query = query.neq(\"amount\", amount);\n                        break;\n                }\n            }\n        }\n        // Apply pagination and sorting\n        const from = (page - 1) * limit;\n        const to = from + limit - 1;\n        // Clone the query for count (before adding order/range)\n        const countQuery = supabase.from(\"main_transaction_details\").select(\"*\", {\n            count: \"exact\",\n            head: true\n        });\n        // IMPORTANT: Exclude balance adjustment transactions from count\n        countQuery.or(\"is_balance_adjustment.is.null,is_balance_adjustment.eq.false\");\n        // Apply same filters to count query\n        if (accountId) {\n            countQuery.eq(\"account_id\", accountId);\n        } else if (entityId && accountIdsForEntity.length > 0) {\n            countQuery.in(\"account_id\", accountIdsForEntity);\n        }\n        if (transactionTypeId) countQuery.eq(\"transaction_type_id\", transactionTypeId);\n        if (categoryId) {\n            if (categoryId === \"none\") {\n                countQuery.is(\"category_id\", null);\n            } else {\n                countQuery.eq(\"category_id\", categoryId);\n            }\n        }\n        if (branchId) countQuery.eq(\"branch_id\", branchId);\n        if (projectId) {\n            if (projectId === \"none\") {\n                countQuery.is(\"project_id\", null);\n            } else {\n                countQuery.eq(\"project_id\", projectId);\n            }\n        }\n        if (transactionDirection) countQuery.eq(\"transaction_direction\", transactionDirection);\n        if (startDate) countQuery.gte(\"transaction_date\", startDate);\n        if (endDate) countQuery.lte(\"transaction_date\", endDate);\n        if (search) countQuery.or(`description.ilike.%${search}%,notes.ilike.%${search}%`);\n        if (isSplit !== null) countQuery.eq(\"is_split\", isSplit === \"true\");\n        if (isUnmatchedTransfer === \"true\") {\n            countQuery.in(\"transaction_type_code\", [\n                \"TRF_OUT\",\n                \"TRF_IN\"\n            ]).is(\"transfer_matched_transaction_id\", null);\n        }\n        if (rawTransactionId) countQuery.eq(\"raw_transaction_id\", rawTransactionId);\n        if (accountTypes) {\n            const typesArray = accountTypes.split(\",\").map((t)=>t.trim());\n            countQuery.in(\"account_type\", typesArray);\n        }\n        if (amountOperator && amountOperator !== \"all\" && amountValue) {\n            const amount = parseFloat(amountValue);\n            if (!isNaN(amount)) {\n                switch(amountOperator){\n                    case \"eq\":\n                        countQuery.eq(\"amount\", amount);\n                        break;\n                    case \"gt\":\n                        countQuery.gt(\"amount\", amount);\n                        break;\n                    case \"lt\":\n                        countQuery.lt(\"amount\", amount);\n                        break;\n                    case \"gte\":\n                        countQuery.gte(\"amount\", amount);\n                        break;\n                    case \"lte\":\n                        countQuery.lte(\"amount\", amount);\n                        break;\n                    case \"neq\":\n                        countQuery.neq(\"amount\", amount);\n                        break;\n                }\n            }\n        }\n        // Validate sort field to prevent SQL injection\n        const allowedSortFields = [\n            \"transaction_date\",\n            \"amount\",\n            \"description\",\n            \"category_name\",\n            \"branch_name\",\n            \"project_name\",\n            \"account_name\"\n        ];\n        const validSortField = allowedSortFields.includes(sortField) ? sortField : \"transaction_date\";\n        const isAscending = sortDirection === \"asc\";\n        // Execute both queries in parallel\n        const [{ data, error }, { count: totalCount, error: countError }] = await Promise.all([\n            query.select(\"*\").order(validSortField, {\n                ascending: isAscending,\n                nullsFirst: false\n            }).order(\"split_sequence\", {\n                ascending: false,\n                nullsFirst: false\n            }) // Secondary sort for splits\n            .order(\"main_transaction_id\", {\n                ascending: false\n            }) // Tertiary sort for consistency\n            .range(from, to),\n            countQuery\n        ]);\n        if (error) {\n            console.error(\"Error fetching main transactions:\", error);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: error.message\n            }, {\n                status: 500\n            });\n        }\n        if (countError) {\n            console.error(\"Error counting main transactions:\", countError);\n        }\n        // Log for debugging\n        console.log(`API: Returning ${data?.length || 0} transactions, total count: ${totalCount}`);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            data: data || [],\n            pagination: {\n                page,\n                limit,\n                total: totalCount ?? 0,\n                totalPages: Math.ceil((totalCount ?? 0) / limit)\n            }\n        });\n    } catch (error) {\n        console.error(\"Unexpected error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"An unexpected error occurred\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL21haW4tdHJhbnNhY3Rpb25zL3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTs7O0NBR0MsR0FFc0Q7QUFDVztBQUVsRSxpRkFBaUY7QUFDakYsdUNBQXVDO0FBQ3ZDLGlGQUFpRjtBQUUxRSxlQUFlRSxLQUFLQyxPQUFvQjtJQUM3QyxJQUFJO1FBQ0YsTUFBTUMsV0FBV0gsZ0ZBQTBCQTtRQUMzQyxNQUFNSSxPQUFPLE1BQU1GLFFBQVFHLElBQUk7UUFFL0IsMkJBQTJCO1FBQzNCLE1BQU0sRUFDSkMsa0JBQWtCLEVBQ2xCQyxVQUFVLEVBQ1ZDLG1CQUFtQixFQUNuQkMsTUFBTSxFQUNOQyxxQkFBcUIsRUFDckJDLGdCQUFnQixFQUNoQkMsV0FBVyxFQUNYQyxXQUFXLEVBQ1hDLFNBQVMsRUFDVEMsS0FBSyxFQUNOLEdBQUdYO1FBRUosSUFBSSxDQUFDRSxzQkFBc0IsQ0FBQ0MsY0FBYyxDQUFDQyx1QkFDdkNDLFdBQVdPLGFBQWEsQ0FBQ04seUJBQXlCLENBQUNDLGtCQUFrQjtZQUN2RSxPQUFPWixxREFBWUEsQ0FBQ00sSUFBSSxDQUN0QjtnQkFBRVksT0FBTztZQUFnSSxHQUN6STtnQkFBRUMsUUFBUTtZQUFJO1FBRWxCO1FBRUEseUJBQXlCO1FBQ3pCLE1BQU0sRUFBRUMsSUFBSSxFQUFFRixLQUFLLEVBQUUsR0FBRyxNQUFNZCxTQUMzQmlCLElBQUksQ0FBQyxvQkFDTEMsTUFBTSxDQUFDO1lBQ05mO1lBQ0FDO1lBQ0FDO1lBQ0FDO1lBQ0FDO1lBQ0FDO1lBQ0FDLGFBQWFBLGVBQWU7WUFDNUJDLGFBQWFBLGVBQWU7WUFDNUJDLFdBQVdBLGFBQWE7WUFDeEJDLE9BQU9BLFNBQVM7UUFDbEIsR0FDQ08sTUFBTSxHQUNOQyxNQUFNO1FBRVQsSUFBSU4sT0FBTztZQUNUTyxRQUFRUCxLQUFLLENBQUMsK0JBQStCQTtZQUM3QyxPQUFPbEIscURBQVlBLENBQUNNLElBQUksQ0FDdEI7Z0JBQUVZLE9BQU9BLE1BQU1RLE9B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QUNkTyxRQUFRUCxLQUFLLENBQUMscUJBQXFCQTtRQUNuQyxPQUFPbEIscURBQVlBLENBQUNNLElBQUksQ0FDdEI7WUFBRVksT0FBTztRQUErQixHQUN4QztZQUFFQyxRQUFRO1FBQUk7SUFFbEI7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL0BmaW5hbmNlYXBwL3dlYi8uL2FwcC9hcGkvbWFpbi10cmFuc2FjdGlvbnMvcm91dGUudHM/Nzg4MCJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEFQSSBSb3V0ZTogL2FwaS9tYWluLXRyYW5zYWN0aW9uc1xuICogUHVycG9zZTogTGlzdCBhbmQgbWFuYWdlIG1haW5fdHJhbnNhY3Rpb24gcmVjb3JkcyB3aXRoIGZ1bGwgY2F0ZWdvcml6YXRpb25cbiAqL1xuXG5pbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInXG5pbXBvcnQgeyBjcmVhdGVTdXBhYmFzZVNlcnZlckNsaWVudCB9IGZyb20gJ0AvbGliL3N1cGFiYXNlLXNlcnZlcidcblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBQT1NUIC0gQ3JlYXRlIGEgbmV3IG1haW4gdHJhbnNhY3Rpb25cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICB0cnkge1xuICAgIGNvbnN0IHN1cGFiYXNlID0gY3JlYXRlU3VwYWJhc2VTZXJ2ZXJDbGllbnQoKVxuICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKVxuXG4gICAgLy8gVmFsaWRhdGUgcmVxdWlyZWQgZmllbGRzXG4gICAgY29uc3Qge1xuICAgICAgcmF3X3RyYW5zYWN0aW9uX2lkLFxuICAgICAgYWNjb3VudF9pZCxcbiAgICAgIHRyYW5zYWN0aW9uX3R5cGVfaWQsXG4gICAgICBhbW91bnQsXG4gICAgICB0cmFuc2FjdGlvbl9kaXJlY3Rpb24sXG4gICAgICB0cmFuc2FjdGlvbl9kYXRlLFxuICAgICAgZGVzY3JpcHRpb24sXG4gICAgICBjYXRlZ29yeV9pZCxcbiAgICAgIGJyYW5jaF9pZCxcbiAgICAgIG5vdGVzLFxuICAgIH0gPSBib2R5XG5cbiAgICBpZiAoIXJhd190cmFuc2FjdGlvbl9pZCB8fCAhYWNjb3VudF9pZCB8fCAhdHJhbnNhY3Rpb25fdHlwZV9pZCB8fFxuICAgICAgICBhbW91bnQgPT09IHVuZGVmaW5lZCB8fCAhdHJhbnNhY3Rpb25fZGlyZWN0aW9uIHx8ICF0cmFuc2FjdGlvbl9kYXRlKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6ICdNaXNzaW5nIHJlcXVpcmVkIGZpZWxkczogcmF3X3RyYW5zYWN0aW9uX2lkLCBhY2NvdW50X2lkLCB0cmFuc2FjdGlvbl90eXBlX2lkLCBhbW91bnQsIHRyYW5zYWN0aW9uX2RpcmVjdGlvbiwgdHJhbnNhY3Rpb25fZGF0ZScgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICApXG4gICAgfVxuXG4gICAgLy8gQ3JlYXRlIHRoZSB0cmFuc2FjdGlvblxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgnbWFpbl90cmFuc2FjdGlvbicpXG4gICAgICAuaW5zZXJ0KHtcbiAgICAgICAgcmF3X3RyYW5zYWN0aW9uX2lkLFxuICAgICAgICBhY2NvdW50X2lkLFxuICAgICAgICB0cmFuc2FjdGlvbl90eXBlX2lkLFxuICAgICAgICBhbW91bnQsXG4gICAgICAgIHRyYW5zYWN0aW9uX2RpcmVjdGlvbixcbiAgICAgICAgdHJhbnNhY3Rpb25fZGF0ZSxcbiAgICAgICAgZGVzY3JpcHRpb246IGRlc2NyaXB0aW9uIHx8IG51bGwsXG4gICAgICAgIGNhdGVnb3J5X2lkOiBjYXRlZ29yeV9pZCB8fCBudWxsLFxuICAgICAgICBicmFuY2hfaWQ6IGJyYW5jaF9pZCB8fCBudWxsLFxuICAgICAgICBub3Rlczogbm90ZXMgfHwgbnVsbCxcbiAgICAgIH0pXG4gICAgICAuc2VsZWN0KClcbiAgICAgIC5zaW5nbGUoKVxuXG4gICAgaWYgKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyB0cmFuc2FjdGlvbjonLCBlcnJvcilcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9LFxuICAgICAgICB7IHN0YXR1czogNTAwIH1cbiAgICAgIClcbiAgICB9XG5cbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBkYXRhIH0sIHsgc3RhdHVzOiAyMDEgfSlcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdVbmV4cGVjdGVkIGVycm9yOicsIGVycm9yKVxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHsgZXJyb3I6ICdBbiB1bmV4cGVjdGVkIGVycm9yIG9jY3VycmVkJyB9LFxuICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgKVxuICB9XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gR0VUIC0gTGlzdCBtYWluIHRyYW5zYWN0aW9ucyB3aXRoIGZpbHRlcnMgYW5kIHBhZ2luYXRpb25cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gR0VUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgY29uc3Qgc3VwYWJhc2UgPSBjcmVhdGVTdXBhYmFzZVNlcnZlckNsaWVudCgpXG5cbiAgICBjb25zdCBzZWFyY2hQYXJhbXMgPSByZXF1ZXN0Lm5leHRVcmwuc2VhcmNoUGFyYW1zXG5cbiAgICAvLyBGaWx0ZXJzXG4gICAgY29uc3QgZW50aXR5SWQgPSBzZWFyY2hQYXJhbXMuZ2V0KCdlbnRpdHlfaWQnKVxuICAgIGNvbnN0IGFjY291bnRJZCA9IHNlYXJjaFBhcmFtcy5nZXQoJ2FjY291bnRfaWQnKVxuICAgIGNvbnN0IHRyYW5zYWN0aW9uVHlwZUlkID0gc2VhcmNoUGFyYW1zLmdldCgndHJhbnNhY3Rpb25fdHlwZV9pZCcpXG4gICAgY29uc3QgY2F0ZWdvcnlJZCA9IHNlYXJjaFBhcmFtcy5nZXQoJ2NhdGVnb3J5X2lkJylcbiAgICBjb25zdCBicmFuY2hJZCA9IHNlYXJjaFBhcmFtcy5nZXQoJ2JyYW5jaF9pZCcpXG4gICAgY29uc3QgcHJvamVjdElkID0gc2VhcmNoUGFyYW1zLmdldCgncHJvamVjdF9pZCcpXG4gICAgY29uc3QgdHJhbnNhY3Rpb25EaXJlY3Rpb24gPSBzZWFyY2hQYXJhbXMuZ2V0KCd0cmFuc2FjdGlvbl9kaXJlY3Rpb24nKVxuICAgIGNvbnN0IHN0YXJ0RGF0ZSA9IHNlYXJjaFBhcmFtcy5nZXQoJ3N0YXJ0X2RhdGUnKVxuICAgIGNvbnN0IGVuZERhdGUgPSBzZWFyY2hQYXJhbXMuZ2V0KCdlbmRfZGF0ZScpXG4gICAgY29uc3Qgc2VhcmNoID0gc2VhcmNoUGFyYW1zLmdldCgnc2VhcmNoJylcbiAgICBjb25zdCBpc1NwbGl0ID0gc2VhcmNoUGFyYW1zLmdldCgnaXNfc3BsaXQnKVxuICAgIGNvbnN0IGlzVW5tYXRjaGVkVHJhbnNmZXIgPSBzZWFyY2hQYXJhbXMuZ2V0KCdpc191bm1hdGNoZWRfdHJhbnNmZXInKVxuICAgIGNvbnN0IHJhd1RyYW5zYWN0aW9uSWQgPSBzZWFyY2hQYXJhbXMuZ2V0KCdyYXdfdHJhbnNhY3Rpb25faWQnKVxuICAgIGNvbnN0IGRyYXdkb3duSWQgPSBzZWFyY2hQYXJhbXMuZ2V0KCdkcmF3ZG93bl9pZCcpXG4gICAgY29uc3QgbG9hbkRpc2J1cnNlbWVudElkID0gc2VhcmNoUGFyYW1zLmdldCgnbG9hbl9kaXNidXJzZW1lbnRfaWQnKVxuICAgIGNvbnN0IGFtb3VudE9wZXJhdG9yID0gc2VhcmNoUGFyYW1zLmdldCgnYW1vdW50X29wZXJhdG9yJylcbiAgICBjb25zdCBhbW91bnRWYWx1ZSA9IHNlYXJjaFBhcmFtcy5nZXQoJ2Ftb3VudF92YWx1ZScpXG4gICAgY29uc3QgYWNjb3VudFR5cGVzID0gc2VhcmNoUGFyYW1zLmdldCgnYWNjb3VudF90eXBlcycpIC8vIGUuZy4sIFwiYmFuayxjYXNoXCJcblxuICAgIC8vIFBhZ2luYXRpb25cbiAgICBjb25zdCBwYWdlID0gcGFyc2VJbnQoc2VhcmNoUGFyYW1zLmdldCgncGFnZScpIHx8ICcxJylcbiAgICBjb25zdCBsaW1pdCA9IHBhcnNlSW50KHNlYXJjaFBhcmFtcy5nZXQoJ2xpbWl0JykgfHwgJzUwJylcblxuICAgIC8vIFNvcnRpbmdcbiAgICBjb25zdCBzb3J0RmllbGQgPSBzZWFyY2hQYXJhbXMuZ2V0KCdzb3J0X2ZpZWxkJykgfHwgJ3RyYW5zYWN0aW9uX2RhdGUnXG4gICAgY29uc3Qgc29ydERpcmVjdGlvbiA9IHNlYXJjaFBhcmFtcy5nZXQoJ3NvcnRfZGlyZWN0aW9uJykgfHwgJ2Rlc2MnXG5cbiAgICAvLyBJZiBlbnRpdHlfaWQgZmlsdGVyIGlzIHByb3ZpZGVkLCBnZXQgYWxsIGFjY291bnQgSURzIGZvciB0aGF0IGVudGl0eSBmaXJzdFxuICAgIGxldCBhY2NvdW50SWRzRm9yRW50aXR5OiBudW1iZXJbXSA9IFtdXG4gICAgaWYgKGVudGl0eUlkICYmICFhY2NvdW50SWQpIHtcbiAgICAgIGNvbnN0IHsgZGF0YTogZW50aXR5QWNjb3VudHMgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdhY2NvdW50cycpXG4gICAgICAgIC5zZWxlY3QoJ2FjY291bnRfaWQnKVxuICAgICAgICAuZXEoJ2VudGl0eV9pZCcsIGVudGl0eUlkKVxuXG4gICAgICBhY2NvdW50SWRzRm9yRW50aXR5ID0gZW50aXR5QWNjb3VudHM/Lm1hcChhID0+IGEuYWNjb3VudF9pZCkgfHwgW11cblxuICAgICAgLy8gSWYgZW50aXR5IGhhcyBubyBhY2NvdW50cywgcmV0dXJuIGVtcHR5IHJlc3VsdFxuICAgICAgaWYgKGFjY291bnRJZHNGb3JFbnRpdHkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICAgICAgZGF0YTogW10sXG4gICAgICAgICAgcGFnaW5hdGlvbjogeyBwYWdlLCBsaW1pdCwgdG90YWw6IDAsIHRvdGFsUGFnZXM6IDAgfVxuICAgICAgICB9KVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIFVzZSB0aGUgdmlldyBmb3IgZnVsbCBkZXRhaWxzXG4gICAgbGV0IHF1ZXJ5ID0gc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdtYWluX3RyYW5zYWN0aW9uX2RldGFpbHMnKVxuICAgICAgLnNlbGVjdCgnKicpXG5cbiAgICAvLyBJTVBPUlRBTlQ6IEV4Y2x1ZGUgYmFsYW5jZSBhZGp1c3RtZW50IHRyYW5zYWN0aW9ucyAoc3lzdGVtLWdlbmVyYXRlZClcbiAgICAvLyBCYWxhbmNlIGFkanVzdG1lbnRzIHNob3VsZCBvbmx5IGJlIHZpZXdlZC9lZGl0ZWQgdGhyb3VnaCBjaGVja3BvaW50c1xuICAgIHF1ZXJ5ID0gcXVlcnkub3IoJ2lzX2JhbGFuY2VfYWRqdXN0bWVudC5pcy5udWxsLGlzX2JhbGFuY2VfYWRqdXN0bWVudC5lcS5mYWxzZScpXG5cbiAgICAvLyBBcHBseSBmaWx0ZXJzXG4gICAgaWYgKGFjY291bnRJZCkge1xuICAgICAgLy8gU3BlY2lmaWMgYWNjb3VudCBmaWx0ZXIgdGFrZXMgcHJpb3JpdHlcbiAgICAgIHF1ZXJ5ID0gcXVlcnkuZXEoJ2FjY291bnRfaWQnLCBhY2NvdW50SWQpXG4gICAgfSBlbHNlIGlmIChlbnRpdHlJZCAmJiBhY2NvdW50SWRzRm9yRW50aXR5Lmxlbmd0aCA+IDApIHtcbiAgICAgIC8vIEZpbHRlciBieSBlbnRpdHkncyBhY2NvdW50c1xuICAgICAgcXVlcnkgPSBxdWVyeS5pbignYWNjb3VudF9pZCcsIGFjY291bnRJZHNGb3JFbnRpdHkpXG4gICAgfVxuXG4gICAgaWYgKHRyYW5zYWN0aW9uVHlwZUlkKSB7XG4gICAgICBxdWVyeSA9IHF1ZXJ5LmVxKCd0cmFuc2FjdGlvbl90eXBlX2lkJywgdHJhbnNhY3Rpb25UeXBlSWQpXG4gICAgfVxuXG4gICAgaWYgKGNhdGVnb3J5SWQpIHtcbiAgICAgIGlmIChjYXRlZ29yeUlkID09PSAnbm9uZScpIHtcbiAgICAgICAgLy8gRmlsdGVyIGZvciB1bmNhdGVnb3JpemVkIHRyYW5zYWN0aW9ucyAoY2F0ZWdvcnlfaWQgaXMgTlVMTClcbiAgICAgICAgcXVlcnkgPSBxdWVyeS5pcygnY2F0ZWdvcnlfaWQnLCBudWxsKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcXVlcnkgPSBxdWVyeS5lcSgnY2F0ZWdvcnlfaWQnLCBjYXRlZ29yeUlkKVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChicmFuY2hJZCkge1xuICAgICAgcXVlcnkgPSBxdWVyeS5lcSgnYnJhbmNoX2lkJywgYnJhbmNoSWQpXG4gICAgfVxuXG4gICAgaWYgKHByb2plY3RJZCkge1xuICAgICAgaWYgKHByb2plY3RJZCA9PT0gJ25vbmUnKSB7XG4gICAgICAgIC8vIEZpbHRlciBmb3IgdHJhbnNhY3Rpb25zIHdpdGhvdXQgYSBwcm9qZWN0IChwcm9qZWN0X2lkIGlzIE5VTEwpXG4gICAgICAgIHF1ZXJ5ID0gcXVlcnkuaXMoJ3Byb2plY3RfaWQnLCBudWxsKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcXVlcnkgPSBxdWVyeS5lcSgncHJvamVjdF9pZCcsIHByb2plY3RJZClcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoZHJhd2Rvd25JZCkge1xuICAgICAgcXVlcnkgPSBxdWVyeS5lcSgnZHJhd2Rvd25faWQnLCBkcmF3ZG93bklkKVxuICAgIH1cblxuICAgIGlmIChsb2FuRGlzYnVyc2VtZW50SWQpIHtcbiAgICAgIHF1ZXJ5ID0gcXVlcnkuZXEoJ2xvYW5fZGlzYnVyc2VtZW50X2lkJywgbG9hbkRpc2J1cnNlbWVudElkKVxuICAgIH1cblxuICAgIGlmICh0cmFuc2FjdGlvbkRpcmVjdGlvbikge1xuICAgICAgcXVlcnkgPSBxdWVyeS5lcSgndHJhbnNhY3Rpb25fZGlyZWN0aW9uJywgdHJhbnNhY3Rpb25EaXJlY3Rpb24pXG4gICAgfVxuXG4gICAgaWYgKHN0YXJ0RGF0ZSkge1xuICAgICAgcXVlcnkgPSBxdWVyeS5ndGUoJ3RyYW5zYWN0aW9uX2RhdGUnLCBzdGFydERhdGUpXG4gICAgfVxuXG4gICAgaWYgKGVuZERhdGUpIHtcbiAgICAgIHF1ZXJ5ID0gcXVlcnkubHRlKCd0cmFuc2FjdGlvbl9kYXRlJywgZW5kRGF0ZSlcbiAgICB9XG5cbiAgICBpZiAoc2VhcmNoKSB7XG4gICAgICBxdWVyeSA9IHF1ZXJ5Lm9yKGBkZXNjcmlwdGlvbi5pbGlrZS4lJHtzZWFyY2h9JSxub3Rlcy5pbGlrZS4lJHtzZWFyY2h9JWApXG4gICAgfVxuXG4gICAgaWYgKGlzU3BsaXQgIT09IG51bGwpIHtcbiAgICAgIHF1ZXJ5ID0gcXVlcnkuZXEoJ2lzX3NwbGl0JywgaXNTcGxpdCA9PT0gJ3RydWUnKVxuICAgIH1cblxuICAgIGlmIChpc1VubWF0Y2hlZFRyYW5zZmVyID09PSAndHJ1ZScpIHtcbiAgICAgIC8vIE9ubHkgc2hvdyB0cmFuc2ZlcnMgd2l0aG91dCBtYXRjaGVzXG4gICAgICBxdWVyeSA9IHF1ZXJ5XG4gICAgICAgIC5pbigndHJhbnNhY3Rpb25fdHlwZV9jb2RlJywgWydUUkZfT1VUJywgJ1RSRl9JTiddKVxuICAgICAgICAuaXMoJ3RyYW5zZmVyX21hdGNoZWRfdHJhbnNhY3Rpb25faWQnLCBudWxsKVxuICAgIH1cblxuICAgIGlmIChyYXdUcmFuc2FjdGlvbklkKSB7XG4gICAgICBxdWVyeSA9IHF1ZXJ5LmVxKCdyYXdfdHJhbnNhY3Rpb25faWQnLCByYXdUcmFuc2FjdGlvbklkKVxuICAgIH1cblxuICAgIC8vIEFjY291bnQgdHlwZSBmaWx0ZXIgKGUuZy4sIG9ubHkgc2hvdyBiYW5rIGFuZCBjYXNoIGFjY291bnRzKVxuICAgIGlmIChhY2NvdW50VHlwZXMpIHtcbiAgICAgIGNvbnN0IHR5cGVzQXJyYXkgPSBhY2NvdW50VHlwZXMuc3BsaXQoJywnKS5tYXAodCA9PiB0LnRyaW0oKSlcbiAgICAgIHF1ZXJ5ID0gcXVlcnkuaW4oJ2FjY291bnRfdHlwZScsIHR5cGVzQXJyYXkpXG4gICAgfVxuXG4gICAgLy8gQW1vdW50IGZpbHRlclxuICAgIGlmIChhbW91bnRPcGVyYXRvciAmJiBhbW91bnRPcGVyYXRvciAhPT0gJ2FsbCcgJiYgYW1vdW50VmFsdWUpIHtcbiAgICAgIGNvbnN0IGFtb3VudCA9IHBhcnNlRmxvYXQoYW1vdW50VmFsdWUpXG4gICAgICBpZiAoIWlzTmFOKGFtb3VudCkpIHtcbiAgICAgICAgc3dpdGNoIChhbW91bnRPcGVyYXRvcikge1xuICAgICAgICAgIGNhc2UgJ2VxJzpcbiAgICAgICAgICAgIHF1ZXJ5ID0gcXVlcnkuZXEoJ2Ftb3VudCcsIGFtb3VudClcbiAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgY2FzZSAnZ3QnOlxuICAgICAgICAgICAgcXVlcnkgPSBxdWVyeS5ndCgnYW1vdW50JywgYW1vdW50KVxuICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICBjYXNlICdsdCc6XG4gICAgICAgICAgICBxdWVyeSA9IHF1ZXJ5Lmx0KCdhbW91bnQnLCBhbW91bnQpXG4gICAgICAgICAgICBicmVha1xuICAgICAgICAgIGNhc2UgJ2d0ZSc6XG4gICAgICAgICAgICBxdWVyeSA9IHF1ZXJ5Lmd0ZSgnYW1vdW50JywgYW1vdW50KVxuICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICBjYXNlICdsdGUnOlxuICAgICAgICAgICAgcXVlcnkgPSBxdWVyeS5sdGUoJ2Ftb3VudCcsIGFtb3VudClcbiAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgY2FzZSAnbmVxJzpcbiAgICAgICAgICAgIHF1ZXJ5ID0gcXVlcnkubmVxKCdhbW91bnQnLCBhbW91bnQpXG4gICAgICAgICAgICBicmVha1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gQXBwbHkgcGFnaW5hdGlvbiBhbmQgc29ydGluZ1xuICAgIGNvbnN0IGZyb20gPSAocGFnZSAtIDEpICogbGltaXRcbiAgICBjb25zdCB0byA9IGZyb20gKyBsaW1pdCAtIDFcblxuICAgIC8vIENsb25lIHRoZSBxdWVyeSBmb3IgY291bnQgKGJlZm9yZSBhZGRpbmcgb3JkZXIvcmFuZ2UpXG4gICAgY29uc3QgY291bnRRdWVyeSA9IHN1cGFiYXNlXG4gICAgICAuZnJvbSgnbWFpbl90cmFuc2FjdGlvbl9kZXRhaWxzJylcbiAgICAgIC5zZWxlY3QoJyonLCB7IGNvdW50OiAnZXhhY3QnLCBoZWFkOiB0cnVlIH0pXG5cbiAgICAvLyBJTVBPUlRBTlQ6IEV4Y2x1ZGUgYmFsYW5jZSBhZGp1c3RtZW50IHRyYW5zYWN0aW9ucyBmcm9tIGNvdW50XG4gICAgY291bnRRdWVyeS5vcignaXNfYmFsYW5jZV9hZGp1c3RtZW50LmlzLm51bGwsaXNfYmFsYW5jZV9hZGp1c3RtZW50LmVxLmZhbHNlJylcblxuICAgIC8vIEFwcGx5IHNhbWUgZmlsdGVycyB0byBjb3VudCBxdWVyeVxuICAgIGlmIChhY2NvdW50SWQpIHtcbiAgICAgIGNvdW50UXVlcnkuZXEoJ2FjY291bnRfaWQnLCBhY2NvdW50SWQpXG4gICAgfSBlbHNlIGlmIChlbnRpdHlJZCAmJiBhY2NvdW50SWRzRm9yRW50aXR5Lmxlbmd0aCA+IDApIHtcbiAgICAgIGNvdW50UXVlcnkuaW4oJ2FjY291bnRfaWQnLCBhY2NvdW50SWRzRm9yRW50aXR5KVxuICAgIH1cbiAgICBpZiAodHJhbnNhY3Rpb25UeXBlSWQpIGNvdW50UXVlcnkuZXEoJ3RyYW5zYWN0aW9uX3R5cGVfaWQnLCB0cmFuc2FjdGlvblR5cGVJZClcbiAgICBpZiAoY2F0ZWdvcnlJZCkge1xuICAgICAgaWYgKGNhdGVnb3J5SWQgPT09ICdub25lJykge1xuICAgICAgICBjb3VudFF1ZXJ5LmlzKCdjYXRlZ29yeV9pZCcsIG51bGwpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb3VudFF1ZXJ5LmVxKCdjYXRlZ29yeV9pZCcsIGNhdGVnb3J5SWQpXG4gICAgICB9XG4gICAgfVxuICAgIGlmIChicmFuY2hJZCkgY291bnRRdWVyeS5lcSgnYnJhbmNoX2lkJywgYnJhbmNoSWQpXG4gICAgaWYgKHByb2plY3RJZCkge1xuICAgICAgaWYgKHByb2plY3RJZCA9PT0gJ25vbmUnKSB7XG4gICAgICAgIGNvdW50UXVlcnkuaXMoJ3Byb2plY3RfaWQnLCBudWxsKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY291bnRRdWVyeS5lcSgncHJvamVjdF9pZCcsIHByb2plY3RJZClcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKHRyYW5zYWN0aW9uRGlyZWN0aW9uKSBjb3VudFF1ZXJ5LmVxKCd0cmFuc2FjdGlvbl9kaXJlY3Rpb24nLCB0cmFuc2FjdGlvbkRpcmVjdGlvbilcbiAgICBpZiAoc3RhcnREYXRlKSBjb3VudFF1ZXJ5Lmd0ZSgndHJhbnNhY3Rpb25fZGF0ZScsIHN0YXJ0RGF0ZSlcbiAgICBpZiAoZW5kRGF0ZSkgY291bnRRdWVyeS5sdGUoJ3RyYW5zYWN0aW9uX2RhdGUnLCBlbmREYXRlKVxuICAgIGlmIChzZWFyY2gpIGNvdW50UXVlcnkub3IoYGRlc2NyaXB0aW9uLmlsaWtlLiUke3NlYXJjaH0lLG5vdGVzLmlsaWtlLiUke3NlYXJjaH0lYClcbiAgICBpZiAoaXNTcGxpdCAhPT0gbnVsbCkgY291bnRRdWVyeS5lcSgnaXNfc3BsaXQnLCBpc1NwbGl0ID09PSAndHJ1ZScpXG4gICAgaWYgKGlzVW5tYXRjaGVkVHJhbnNmZXIgPT09ICd0cnVlJykge1xuICAgICAgY291bnRRdWVyeS5pbigndHJhbnNhY3Rpb25fdHlwZV9jb2RlJywgWydUUkZfT1VUJywgJ1RSRl9JTiddKS5pcygndHJhbnNmZXJfbWF0Y2hlZF90cmFuc2FjdGlvbl9pZCcsIG51bGwpXG4gICAgfVxuICAgIGlmIChyYXdUcmFuc2FjdGlvbklkKSBjb3VudFF1ZXJ5LmVxKCdyYXdfdHJhbnNhY3Rpb25faWQnLCByYXdUcmFuc2FjdGlvbklkKVxuICAgIGlmIChhY2NvdW50VHlwZXMpIHtcbiAgICAgIGNvbnN0IHR5cGVzQXJyYXkgPSBhY2NvdW50VHlwZXMuc3BsaXQoJywnKS5tYXAodCA9PiB0LnRyaW0oKSlcbiAgICAgIGNvdW50UXVlcnkuaW4oJ2FjY291bnRfdHlwZScsIHR5cGVzQXJyYXkpXG4gICAgfVxuICAgIGlmIChhbW91bnRPcGVyYXRvciAmJiBhbW91bnRPcGVyYXRvciAhPT0gJ2FsbCcgJiYgYW1vdW50VmFsdWUpIHtcbiAgICAgIGNvbnN0IGFtb3VudCA9IHBhcnNlRmxvYXQoYW1vdW50VmFsdWUpXG4gICAgICBpZiAoIWlzTmFOKGFtb3VudCkpIHtcbiAgICAgICAgc3dpdGNoIChhbW91bnRPcGVyYXRvcikge1xuICAgICAgICAgIGNhc2UgJ2VxJzogY291bnRRdWVyeS5lcSgnYW1vdW50JywgYW1vdW50KTsgYnJlYWtcbiAgICAgICAgICBjYXNlICdndCc6IGNvdW50UXVlcnkuZ3QoJ2Ftb3VudCcsIGFtb3VudCk7IGJyZWFrXG4gICAgICAgICAgY2FzZSAnbHQnOiBjb3VudFF1ZXJ5Lmx0KCdhbW91bnQnLCBhbW91bnQpOyBicmVha1xuICAgICAgICAgIGNhc2UgJ2d0ZSc6IGNvdW50UXVlcnkuZ3RlKCdhbW91bnQnLCBhbW91bnQpOyBicmVha1xuICAgICAgICAgIGNhc2UgJ2x0ZSc6IGNvdW50UXVlcnkubHRlKCdhbW91bnQnLCBhbW91bnQpOyBicmVha1xuICAgICAgICAgIGNhc2UgJ25lcSc6IGNvdW50UXVlcnkubmVxKCdhbW91bnQnLCBhbW91bnQpOyBicmVha1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gVmFsaWRhdGUgc29ydCBmaWVsZCB0byBwcmV2ZW50IFNRTCBpbmplY3Rpb25cbiAgICBjb25zdCBhbGxvd2VkU29ydEZpZWxkcyA9IFtcbiAgICAgICd0cmFuc2FjdGlvbl9kYXRlJyxcbiAgICAgICdhbW91bnQnLFxuICAgICAgJ2Rlc2NyaXB0aW9uJyxcbiAgICAgICdjYXRlZ29yeV9uYW1lJyxcbiAgICAgICdicmFuY2hfbmFtZScsXG4gICAgICAncHJvamVjdF9uYW1lJyxcbiAgICAgICdhY2NvdW50X25hbWUnXG4gICAgXVxuICAgIGNvbnN0IHZhbGlkU29ydEZpZWxkID0gYWxsb3dlZFNvcnRGaWVsZHMuaW5jbHVkZXMoc29ydEZpZWxkKSA/IHNvcnRGaWVsZCA6ICd0cmFuc2FjdGlvbl9kYXRlJ1xuICAgIGNvbnN0IGlzQXNjZW5kaW5nID0gc29ydERpcmVjdGlvbiA9PT0gJ2FzYydcblxuICAgIC8vIEV4ZWN1dGUgYm90aCBxdWVyaWVzIGluIHBhcmFsbGVsXG4gICAgY29uc3QgW3sgZGF0YSwgZXJyb3IgfSwgeyBjb3VudDogdG90YWxDb3VudCwgZXJyb3I6IGNvdW50RXJyb3IgfV0gPSBhd2FpdCBQcm9taXNlLmFsbChbXG4gICAgICBxdWVyeVxuICAgICAgICAuc2VsZWN0KCcqJylcbiAgICAgICAgLm9yZGVyKHZhbGlkU29ydEZpZWxkLCB7IGFzY2VuZGluZzogaXNBc2NlbmRpbmcsIG51bGxzRmlyc3Q6IGZhbHNlIH0pXG4gICAgICAgIC5vcmRlcignc3BsaXRfc2VxdWVuY2UnLCB7IGFzY2VuZGluZzogZmFsc2UsIG51bGxzRmlyc3Q6IGZhbHNlIH0pIC8vIFNlY29uZGFyeSBzb3J0IGZvciBzcGxpdHNcbiAgICAgICAgLm9yZGVyKCdtYWluX3RyYW5zYWN0aW9uX2lkJywgeyBhc2NlbmRpbmc6IGZhbHNlIH0pIC8vIFRlcnRpYXJ5IHNvcnQgZm9yIGNvbnNpc3RlbmN5XG4gICAgICAgIC5yYW5nZShmcm9tLCB0byksXG4gICAgICBjb3VudFF1ZXJ5XG4gICAgXSlcblxuICAgIGlmIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgbWFpbiB0cmFuc2FjdGlvbnM6JywgZXJyb3IpXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9LCB7IHN0YXR1czogNTAwIH0pXG4gICAgfVxuXG4gICAgaWYgKGNvdW50RXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNvdW50aW5nIG1haW4gdHJhbnNhY3Rpb25zOicsIGNvdW50RXJyb3IpXG4gICAgfVxuXG4gICAgLy8gTG9nIGZvciBkZWJ1Z2dpbmdcbiAgICBjb25zb2xlLmxvZyhgQVBJOiBSZXR1cm5pbmcgJHtkYXRhPy5sZW5ndGggfHwgMH0gdHJhbnNhY3Rpb25zLCB0b3RhbCBjb3VudDogJHt0b3RhbENvdW50fWApXG5cbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgZGF0YTogZGF0YSB8fCBbXSxcbiAgICAgIHBhZ2luYXRpb246IHtcbiAgICAgICAgcGFnZSxcbiAgICAgICAgbGltaXQsXG4gICAgICAgIHRvdGFsOiB0b3RhbENvdW50ID8/IDAsXG4gICAgICAgIHRvdGFsUGFnZXM6IE1hdGguY2VpbCgodG90YWxDb3VudCA/PyAwKSAvIGxpbWl0KSxcbiAgICAgIH0sXG4gICAgfSlcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdVbmV4cGVjdGVkIGVycm9yOicsIGVycm9yKVxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHsgZXJyb3I6ICdBbiB1bmV4cGVjdGVkIGVycm9yIG9jY3VycmVkJyB9LFxuICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgKVxuICB9XG59XG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiY3JlYXRlU3VwYWJhc2VTZXJ2ZXJDbGllbnQiLCJQT1NUIiwicmVxdWVzdCIsInN1cGFiYXNlIiwiYm9keSIsImpzb24iLCJyYXdfdHJhbnNhY3Rpb25faWQiLCJhY2NvdW50X2lkIiwidHJhbnNhY3Rpb25fdHlwZV9pZCIsImFtb3VudCIsInRyYW5zYWN0aW9uX2RpcmVjdGlvbiIsInRyYW5zYWN0aW9uX2RhdGUiLCJkZXNjcmlwdGlvbiIsImNhdGVnb3J5X2lkIiwiYnJhbmNoX2lkIiwibm90ZXMiLCJ1bmRlZmluZWQiLCJlcnJvciIsInN0YXR1cyIsImRhdGEiLCJmcm9tIiwiaW5zZXJ0Iiwic2VsZWN0Iiwic2luZ2xlIiwiY29uc29sZSIsIm1lc3NhZ2UiLCJHRVQiLCJzZWFyY2hQYXJhbXMiLCJuZXh0VXJsIiwiZW50aXR5SWQiLCJnZXQiLCJhY2NvdW50SWQiLCJ0cmFuc2FjdGlvblR5cGVJZCIsImNhdGVnb3J5SWQiLCJicmFuY2hJZCIsInByb2plY3RJZCIsInRyYW5zYWN0aW9uRGlyZWN0aW9uIiwic3RhcnREYXRlIiwiZW5kRGF0ZSIsInNlYXJjaCIsImlzU3BsaXQiLCJpc1VubWF0Y2hlZFRyYW5zZmVyIiwicmF3VHJhbnNhY3Rpb25JZCIsImRyYXdkb3duSWQiLCJsb2FuRGlzYnVyc2VtZW50SWQiLCJhbW91bnRPcGVyYXRvciIsImFtb3VudFZhbHVlIiwiYWNjb3VudFR5cGVzIiwicGFnZSIsInBhcnNlSW50IiwibGltaXQiLCJzb3J0RmllbGQiLCJzb3J0RGlyZWN0aW9uIiwiYWNjb3VudElkc0ZvckVudGl0eSIsImVudGl0eUFjY291bnRzIiwiZXEiLCJtYXAiLCJhIiwibGVuZ3RoIiwicGFnaW5hdGlvbiIsInRvdGFsIiwidG90YWxQYWdlcyIsInF1ZXJ5Iiwib3IiLCJpbiIsImlzIiwiZ3RlIiwibHRlIiwidHlwZXNBcnJheSIsInNwbGl0IiwidCIsInRyaW0iLCJwYXJzZUZsb2F0IiwiaXNOYU4iLCJndCIsImx0IiwibmVxIiwidG8iLCJjb3VudFF1ZXJ5IiwiY291bnQiLCJoZWFkIiwiYWxsb3dlZFNvcnRGaWVsZHMiLCJ2YWxpZFNvcnRGaWVsZCIsImluY2x1ZGVzIiwiaXNBc2NlbmRpbmciLCJ0b3RhbENvdW50IiwiY291bnRFcnJvciIsIlByb21pc2UiLCJhbGwiLCJvcmRlciIsImFzY2VuZGluZyIsIm51bGxzRmlyc3QiLCJyYW5nZSIsImxvZyIsIk1hdGgiLCJjZWlsIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/main-transactions/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/supabase-server.ts":
/*!********************************!*\
  !*** ./lib/supabase-server.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createSupabaseServerClient: () => (/* binding */ createSupabaseServerClient),\n/* harmony export */   getCurrentUser: () => (/* binding */ getCurrentUser),\n/* harmony export */   requireAuth: () => (/* binding */ requireAuth)\n/* harmony export */ });\n/* harmony import */ var _supabase_ssr__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/ssr */ \"(rsc)/../../node_modules/@supabase/ssr/dist/module/index.js\");\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/headers */ \"(rsc)/../../node_modules/next/dist/api/headers.js\");\n\n\nfunction createSupabaseServerClient() {\n    const cookieStore = (0,next_headers__WEBPACK_IMPORTED_MODULE_1__.cookies)();\n    return (0,_supabase_ssr__WEBPACK_IMPORTED_MODULE_0__.createServerClient)(\"https://mflyrbzriksgjutlalkf.supabase.co\", \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1mbHlyYnpyaWtzZ2p1dGxhbGtmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjIyMjQ3MjcsImV4cCI6MjA3NzgwMDcyN30.O9hwKR6Vxb_vJhPrYedwQWkTCvfApcvBfnasSLt1vyY\", {\n        cookies: {\n            get (name) {\n                return cookieStore.get(name)?.value;\n            },\n            set (name, value, options) {\n                try {\n                    cookieStore.set({\n                        name,\n                        value,\n                        ...options\n                    });\n                } catch (error) {\n                // The `set` method was called from a Server Component.\n                // This can be ignored if you have middleware refreshing\n                // user sessions.\n                }\n            },\n            remove (name, options) {\n                try {\n                    cookieStore.set({\n                        name,\n                        value: \"\",\n                        ...options\n                    });\n                } catch (error) {\n                // The `delete` method was called from a Server Component.\n                // This can be ignored if you have middleware refreshing\n                // user sessions.\n                }\n            }\n        }\n    });\n}\n// Helper function to get the current user from server components\nasync function getCurrentUser() {\n    const supabase = createSupabaseServerClient();\n    const { data: { user }, error } = await supabase.auth.getUser();\n    if (error || !user) {\n        return null;\n    }\n    return user;\n}\n// Helper function to check if user is authenticated\nasync function requireAuth() {\n    const user = await getCurrentUser();\n    if (!user) {\n        throw new Error(\"Unauthorized\");\n    }\n    return user;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc3VwYWJhc2Utc2VydmVyLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQXNFO0FBQ2hDO0FBRS9CLFNBQVNFO0lBQ2QsTUFBTUMsY0FBY0YscURBQU9BO0lBRTNCLE9BQU9ELGlFQUFrQkEsQ0FDdkJJLDBDQUFvQyxFQUNwQ0Esa05BQXlDLEVBQ3pDO1FBQ0VILFNBQVM7WUFDUE8sS0FBSUMsSUFBWTtnQkFDZCxPQUFPTixZQUFZSyxHQUFHLENBQUNDLE9BQU9DO1lBQ2hDO1lBQ0FDLEtBQUlGLElBQVksRUFBRUMsS0FBYSxFQUFFRSxPQUFzQjtnQkFDckQsSUFBSTtvQkFDRlQsWUFBWVEsR0FBRyxDQUFDO3dCQUFFRjt3QkFBTUM7d0JBQU8sR0FBR0UsT0FBTztvQkFBQztnQkFDNUMsRUFBRSxPQUFPQyxPQUFPO2dCQUNkLHVEQUF1RDtnQkFDdkQsd0RBQXdEO2dCQUN4RCxpQkFBaUI7Z0JBQ25CO1lBQ0Y7WUFDQUMsUUFBT0wsSUFBWSxFQUFFRyxPQUFzQjtnQkFDekMsSUFBSTtvQkFDRlQsWUFBWVEsR0FBRyxDQUFDO3dCQUFFRjt3QkFBTUMsT0FBTzt3QkFBSSxHQUFHRSxPQUFPO29CQUFDO2dCQUNoRCxFQUFFLE9BQU9DLE9BQU87Z0JBQ2QsMERBQTBEO2dCQUMxRCx3REFBd0Q7Z0JBQ3hELGlCQUFpQjtnQkFDbkI7WUFDRjtRQUNGO0lBQ0Y7QUFFSjtBQUVBLGlFQUFpRTtBQUMxRCxlQUFlRTtJQUNwQixNQUFNQyxXQUFXZDtJQUNqQixNQUFNLEVBQUVlLE1BQU0sRUFBRUMsSUFBSSxFQUFFLEVBQUVMLEtBQUssRUFBRSxHQUFHLE1BQU1HLFNBQVNHLElBQUksQ0FBQ0MsT0FBTztJQUU3RCxJQUFJUCxTQUFTLENBQUNLLE1BQU07UUFDbEIsT0FBTztJQUNUO0lBRUEsT0FBT0E7QUFDVDtBQUVBLG9EQUFvRDtBQUM3QyxlQUFlRztJQUNwQixNQUFNSCxPQUFPLE1BQU1IO0lBRW5CLElBQUksQ0FBQ0csTUFBTTtRQUNULE1BQU0sSUFBSUksTUFBTTtJQUNsQjtJQUVBLE9BQU9KO0FBQ1QiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9AZmluYW5jZWFwcC93ZWIvLi9saWIvc3VwYWJhc2Utc2VydmVyLnRzPzA5NGYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlU2VydmVyQ2xpZW50LCB0eXBlIENvb2tpZU9wdGlvbnMgfSBmcm9tICdAc3VwYWJhc2Uvc3NyJ1xuaW1wb3J0IHsgY29va2llcyB9IGZyb20gJ25leHQvaGVhZGVycydcblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVN1cGFiYXNlU2VydmVyQ2xpZW50KCkge1xuICBjb25zdCBjb29raWVTdG9yZSA9IGNvb2tpZXMoKVxuXG4gIHJldHVybiBjcmVhdGVTZXJ2ZXJDbGllbnQoXG4gICAgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMISxcbiAgICBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSEsXG4gICAge1xuICAgICAgY29va2llczoge1xuICAgICAgICBnZXQobmFtZTogc3RyaW5nKSB7XG4gICAgICAgICAgcmV0dXJuIGNvb2tpZVN0b3JlLmdldChuYW1lKT8udmFsdWVcbiAgICAgICAgfSxcbiAgICAgICAgc2V0KG5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZywgb3B0aW9uczogQ29va2llT3B0aW9ucykge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb29raWVTdG9yZS5zZXQoeyBuYW1lLCB2YWx1ZSwgLi4ub3B0aW9ucyB9KVxuICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAvLyBUaGUgYHNldGAgbWV0aG9kIHdhcyBjYWxsZWQgZnJvbSBhIFNlcnZlciBDb21wb25lbnQuXG4gICAgICAgICAgICAvLyBUaGlzIGNhbiBiZSBpZ25vcmVkIGlmIHlvdSBoYXZlIG1pZGRsZXdhcmUgcmVmcmVzaGluZ1xuICAgICAgICAgICAgLy8gdXNlciBzZXNzaW9ucy5cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHJlbW92ZShuYW1lOiBzdHJpbmcsIG9wdGlvbnM6IENvb2tpZU9wdGlvbnMpIHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29va2llU3RvcmUuc2V0KHsgbmFtZSwgdmFsdWU6ICcnLCAuLi5vcHRpb25zIH0pXG4gICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIC8vIFRoZSBgZGVsZXRlYCBtZXRob2Qgd2FzIGNhbGxlZCBmcm9tIGEgU2VydmVyIENvbXBvbmVudC5cbiAgICAgICAgICAgIC8vIFRoaXMgY2FuIGJlIGlnbm9yZWQgaWYgeW91IGhhdmUgbWlkZGxld2FyZSByZWZyZXNoaW5nXG4gICAgICAgICAgICAvLyB1c2VyIHNlc3Npb25zLlxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgfVxuICApXG59XG5cbi8vIEhlbHBlciBmdW5jdGlvbiB0byBnZXQgdGhlIGN1cnJlbnQgdXNlciBmcm9tIHNlcnZlciBjb21wb25lbnRzXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q3VycmVudFVzZXIoKSB7XG4gIGNvbnN0IHN1cGFiYXNlID0gY3JlYXRlU3VwYWJhc2VTZXJ2ZXJDbGllbnQoKVxuICBjb25zdCB7IGRhdGE6IHsgdXNlciB9LCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2UuYXV0aC5nZXRVc2VyKClcblxuICBpZiAoZXJyb3IgfHwgIXVzZXIpIHtcbiAgICByZXR1cm4gbnVsbFxuICB9XG5cbiAgcmV0dXJuIHVzZXJcbn1cblxuLy8gSGVscGVyIGZ1bmN0aW9uIHRvIGNoZWNrIGlmIHVzZXIgaXMgYXV0aGVudGljYXRlZFxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlcXVpcmVBdXRoKCkge1xuICBjb25zdCB1c2VyID0gYXdhaXQgZ2V0Q3VycmVudFVzZXIoKVxuXG4gIGlmICghdXNlcikge1xuICAgIHRocm93IG5ldyBFcnJvcignVW5hdXRob3JpemVkJylcbiAgfVxuXG4gIHJldHVybiB1c2VyXG59XG4iXSwibmFtZXMiOlsiY3JlYXRlU2VydmVyQ2xpZW50IiwiY29va2llcyIsImNyZWF0ZVN1cGFiYXNlU2VydmVyQ2xpZW50IiwiY29va2llU3RvcmUiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkiLCJnZXQiLCJuYW1lIiwidmFsdWUiLCJzZXQiLCJvcHRpb25zIiwiZXJyb3IiLCJyZW1vdmUiLCJnZXRDdXJyZW50VXNlciIsInN1cGFiYXNlIiwiZGF0YSIsInVzZXIiLCJhdXRoIiwiZ2V0VXNlciIsInJlcXVpcmVBdXRoIiwiRXJyb3IiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/supabase-server.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/@supabase","vendor-chunks/next","vendor-chunks/tslib","vendor-chunks/iceberg-js","vendor-chunks/cookie"], () => (__webpack_exec__("(rsc)/../../node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fmain-transactions%2Froute&page=%2Fapi%2Fmain-transactions%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmain-transactions%2Froute.ts&appDir=%2FUsers%2Ftrunghuynh%2FDeveloper%2FFinanceapp%2Fapps%2Fweb%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Ftrunghuynh%2FDeveloper%2FFinanceapp%2Fapps%2Fweb&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();